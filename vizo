"externalJS": ["node_modules/plotly.js-dist-min/plotly.min.js"]




import { Visual } from "./visual";
import powerbiVisualsApi from "powerbi-visuals-api";
import IVisualHost = powerbiVisualsApi.extensibility.visual.IVisualHost;
import DataView = powerbiVisualsApi.DataView;
import IViewport = powerbiVisualsApi.IViewport;

import Plotly from 'plotly.js-dist-min';

export class Visual implements powerbiVisualsApi.extensibility.visual.IVisual {
    private host: IVisualHost;
    private target: HTMLElement;

    constructor(options: powerbiVisualsApi.extensibility.visual.VisualConstructorOptions) {
        this.host = options.host;
        this.target = options.element;
    }

    public update(options: powerbiVisualsApi.extensibility.visual.VisualUpdateOptions) {
        this.renderChart(options.viewport);
    }

    private renderChart(viewport: IViewport): void {
        const data = [{
            x: Array.from({length: 10}, (_, i) => i + 1),
            y: Array.from({length: 10}, () => Math.random()),
            type: 'scatter',
            mode: 'lines+markers',
            marker: {color: 'blue'}
        }];

        const layout = {
            title: 'Random Data Line Chart',
            autosize: true,
            width: viewport.width,
            height: viewport.height,
            margin: { t: 30, b: 40, l: 40, r: 30 }
        };

        Plotly.newPlot(this.target, data, layout, {responsive: true});
    }
}
